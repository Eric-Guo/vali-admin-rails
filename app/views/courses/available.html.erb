<main class="app-content">
  <div class="app-title">
    <div>
      <h1><i class="fa fa-sign-in"></i> <%= t('ui.training_user_add') -%></h1>
      <p>培训信息</p>
    </div>
  </div>
  <% @courses.each_with_index do |course, index| -%>
    <% if index.even? -%>
      <div class="row">
    <% end -%>
        <div class="col-md-6">
          <div class="tile">
            <h3 class="tile-title"><%= course.title -%></h3>
            <div class="tile-body">
              <% course.vertical_markets.each do |vm| -%>
                <span class="badge badge-primary"><%= vm.name -%></span>
              <% end -%>
              <br />
              <%= simple_format course.body -%>
              <br />
              <%= t('course.address') -%>: <%= course.address -%>
              <br />
              <span class="badge badge-info"><%= t('course.status.title') -%>: <%= course.status -%></span>
              <span class="badge badge-secondary"><%= t('course.rsvp_count') -%>: <%= current_course_users(course, current_user).count -%></span>
            </div>
            <div class="tile-footer">
              <% if current_user.nil? %>
                <a class="btn btn-primary" href="<%= new_user_session_path -%>" role="button"><%= t('ui.training_user_signin') -%></a>
              <% elsif policy(course).update? %>
                <% if course.status == I18n.t('course.status.end') -%>
                  <%= link_to t('ui.training_user_end'), course_path(course), class: 'btn btn-secondary disabled', role: 'button' -%>
                <% elsif course.status == I18n.t('course.status.full') -%>
                  <%= link_to t('ui.training_user_full'), course_path(course), class: 'btn btn-secondary disabled', role: 'button' -%>
                <% else -%>
                  <%= link_to t('ui.training_user_manage'), course_path(course), class: 'btn btn-primary', role: 'button' -%>
                <% end %>
              <% elsif course.users.exists?(current_user.id) -%>
                <a class="btn btn-primary disabled" href="#" role="button"><i class="fa fa-sign-in"></i><%= t('ui.training_user_exist') -%></a>
              <% else -%>
                <%= link_to course_rsvp_path(course, current_user), method: :put, class: 'btn btn-primary', role: 'button', disable_with: t('ui.training_user_exist') do %>
                  <i class="fa fa-sign-in"></i><%= t('ui.training_user_rsvp') -%>
                <% end %>
              <% end -%>
            </div>
          </div>
        </div>
    <% if index.odd? -%>
      </div>
    <% end -%>
  <% end -%>
</main>
